DROP SCHEMA public CASCADE;
CREATE SCHEMA public;

-- Везде добавил s'ки
-- Везде поменял group на student_group

CREATE TABLE Users(
user_id SERIAL PRIMARY KEY,
username VARCHAR(255),
email VARCHAR(255) UNIQUE,
password VARCHAR(50)
);

-- Удалил email
CREATE TABLE ProfileStudent(
profile_id SERIAL PRIMARY KEY,
last_name VARCHAR(100),
name VARCHAR(100),
surname VARCHAR(100),
birth_date DATE,
phone VARCHAR(11) UNIQUE,
student_group VARCHAR(15),
user_id INTEGER UNIQUE,
FOREIGN KEY (user_id) REFERENCES Users(user_id)
);

CREATE TABLE ProfileTeacher(
profile_id SERIAL PRIMARY KEY,
last_name VARCHAR(100),
name VARCHAR(100),
surname VARCHAR(100),
birth_date DATE,
phone VARCHAR(11) UNIQUE,
user_id INTEGER UNIQUE,
FOREIGN KEY (user_id) REFERENCES Users(user_id)
);

CREATE TABLE Courses(
course_id SERIAL PRIMARY KEY,
title VARCHAR(255),
description TEXT,
course_owner INTEGER,
FOREIGN KEY (course_owner) REFERENCES ProfileTeacher(profile_id)
);

CREATE TABLE CourseParticipants(
course_id INTEGER,
profile_id INTEGER,
FOREIGN KEY (course_id) REFERENCES Courses(course_id),
FOREIGN KEY (profile_id) REFERENCES ProfileStudent(profile_id),
PRIMARY KEY (course_id, profile_id)
);

-- Переименовал course в course_id
CREATE TABLE Lessons(
lesson_id SERIAL PRIMARY KEY,
title VARCHAR(255),
description TEXT,
start_date TIME,
expire_date TIME,
course_id INTEGER,
FOREIGN KEY (course_id) REFERENCES Courses(course_id)
);

-- Переименовал date в notification_date
CREATE TABLE Notifications(
notification_id SERIAL PRIMARY KEY,
title VARCHAR(255),
description TEXT,
notification_date DATE,
profile_id INTEGER,
FOREIGN KEY (profile_id) REFERENCES ProfileStudent(profile_id)
);

CREATE TABLE Grades(
grade_id SERIAL PRIMARY KEY,
profile_id integer,
course_id integer,
grade smallint,
FOREIGN KEY (profile_id) REFERENCES ProfileStudent(profile_id),
FOREIGN KEY (course_id) REFERENCES Courses(course_id)
);
